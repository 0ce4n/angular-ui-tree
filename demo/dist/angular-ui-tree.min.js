/*
 Angular UI Tree v2.0.11
 (c) 2010-2014. https://github.com/JimLiu/angular-ui-tree
 License: MIT
*/
(function(){angular.module("ui.tree",[]).constant("treeConfig",{treeClass:"angular-ui-tree",emptyTreeClass:"angular-ui-tree-empty",hiddenClass:"angular-ui-tree-hidden",nodesClass:"angular-ui-tree-nodes",nodeClass:"angular-ui-tree-node",handleClass:"angular-ui-tree-handle",placeHolderClass:"angular-ui-tree-placeholder",dragClass:"angular-ui-tree-drag",dragThreshold:3,levelThreshold:30})})();
(function(){angular.module("ui.tree").factory("$uiTreeHelper",["$document","$window",function(a,f){return{nodesData:{},setNodeAttribute:function(a,b,c){var d=this.nodesData[a.$modelValue.$$hashKey];d||(d={},this.nodesData[a.$modelValue.$$hashKey]=d);d[b]=c},getNodeAttribute:function(a,b){var c=this.nodesData[a.$modelValue.$$hashKey];return c?c[b]:null},nodrag:function(a){return"undefined"!=typeof a.attr("data-nodrag")},eventObj:function(a){var b=a;void 0!==a.targetTouches?b=a.targetTouches.item(0):
void 0!==a.originalEvent&&void 0!==a.originalEvent.targetTouches&&(b=a.originalEvent.targetTouches.item(0));return b},dragInfo:function(a){return{source:a,sourceInfo:{nodeScope:a,index:a.index(),nodesScope:a.$parentNodesScope},index:a.index(),siblings:a.siblings().slice(0),parent:a.$parentNodesScope,moveTo:function(a,c,d){this.parent=a;this.siblings=c.slice(0);a=this.siblings.indexOf(this.source);-1<a&&(this.siblings.splice(a,1),this.source.index()<d&&d--);this.siblings.splice(d,0,this.source);this.index=
d},parentNode:function(){return this.parent.$nodeScope},prev:function(){return 0<this.index?this.siblings[this.index-1]:null},next:function(){return this.index<this.siblings.length-1?this.siblings[this.index+1]:null},isDirty:function(){return this.source.$parentNodesScope!=this.parent||this.source.index()!=this.index},eventArgs:function(a,c){return{source:this.sourceInfo,dest:{index:this.index,nodesScope:this.parent},elements:a,pos:c}},apply:function(){var a=this.source.$modelValue;this.source.remove();
this.parent.insertNode(this.index,a)}}},height:function(a){return a.prop("scrollHeight")},width:function(a){return a.prop("scrollWidth")},offset:function(e){var b=e[0].getBoundingClientRect();return{width:e.prop("offsetWidth"),height:e.prop("offsetHeight"),top:b.top+(f.pageYOffset||a[0].body.scrollTop||a[0].documentElement.scrollTop),left:b.left+(f.pageXOffset||a[0].body.scrollLeft||a[0].documentElement.scrollLeft)}},positionStarted:function(a,b){var c={};c.offsetX=a.pageX-this.offset(b).left;c.offsetY=
a.pageY-this.offset(b).top;c.startX=c.lastX=a.pageX;c.startY=c.lastY=a.pageY;c.nowX=c.nowY=c.distX=c.distY=c.dirAx=0;c.dirX=c.dirY=c.lastDirX=c.lastDirY=c.distAxX=c.distAxY=0;return c},positionMoved:function(a,b,c){b.lastX=b.nowX;b.lastY=b.nowY;b.nowX=a.pageX;b.nowY=a.pageY;b.distX=b.nowX-b.lastX;b.distY=b.nowY-b.lastY;b.lastDirX=b.dirX;b.lastDirY=b.dirY;b.dirX=0===b.distX?0:0<b.distX?1:-1;b.dirY=0===b.distY?0:0<b.distY?1:-1;a=Math.abs(b.distX)>Math.abs(b.distY)?1:0;c?(b.dirAx=a,b.moving=!0):(b.dirAx!==
a?(b.distAxX=0,b.distAxY=0):(b.distAxX+=Math.abs(b.distX),0!==b.dirX&&b.dirX!==b.lastDirX&&(b.distAxX=0),b.distAxY+=Math.abs(b.distY),0!==b.dirY&&b.dirY!==b.lastDirY&&(b.distAxY=0)),b.dirAx=a)}}}])})();
(function(){angular.module("ui.tree").controller("TreeController",["$scope","$element","$attrs","treeConfig",function(a,f,e,b){this.scope=a;a.$element=f;a.$nodesScope=null;a.$type="uiTree";a.$emptyElm=null;a.$callbacks=null;a.dragEnabled=!0;a.maxDepth=0;a.dragDelay=0;a.isEmpty=function(){return a.$nodesScope&&a.$nodesScope.$modelValue&&0===a.$nodesScope.$modelValue.length};a.place=function(b){a.$nodesScope.$element.append(b);a.$emptyElm.remove()};a.resetEmptyElement=function(){0===a.$nodesScope.$modelValue.length?
f.append(a.$emptyElm):a.$emptyElm.remove()};var c=function(a,b){for(var q=a.childNodes(),e=0;e<q.length;e++){b?q[e].collapse():q[e].expand();var f=q[e].$childNodesScope;f&&c(f,b)}};a.collapseAll=function(){c(a.$nodesScope,!0)};a.expandAll=function(){c(a.$nodesScope,!1)}}])})();
(function(){angular.module("ui.tree").controller("TreeNodesController",["$scope","$element","$timeout","treeConfig",function(a,f,e,b){this.scope=a;a.$element=f;a.$modelValue=null;a.$nodeScope=null;a.$treeScope=null;a.$type="uiTreeNodes";a.$nodesMap={};a.nodrop=!1;a.maxDepth=0;a.initSubNode=function(b){e(function(){a.$nodesMap[b.$modelValue.$$hashKey]=b})};a.destroySubNode=function(b){a.$nodesMap[b.$modelValue.$$hashKey]=null};a.accept=function(b,d){return a.$treeScope.$callbacks.accept(b,a,d)};a.isParent=
function(b){return b.$parentNodesScope==a};a.hasChild=function(){return 0<a.$modelValue.length};a.safeApply=function(a){var b=this.$root.$$phase;"$apply"==b||"$digest"==b?a&&"function"===typeof a&&a():this.$apply(a)};a.removeNode=function(b){var d=a.$modelValue.indexOf(b.$modelValue);return-1<d?(a.safeApply(function(){a.$modelValue.splice(d,1)[0]}),b):null};a.insertNode=function(b,d){a.safeApply(function(){a.$modelValue.splice(b,0,d)})};a.childNodes=function(){var b=[];if(a.$modelValue)for(var d=
0;d<a.$modelValue.length;d++)b.push(a.$nodesMap[a.$modelValue[d].$$hashKey]);return b};a.depth=function(){return a.$nodeScope?a.$nodeScope.depth():0};a.outOfDepth=function(b){var d=a.maxDepth||a.$treeScope.maxDepth;return 0<d?a.depth()+b.maxSubDepth()+1>d:!1}}])})();
(function(){angular.module("ui.tree").controller("TreeNodeController",["$scope","$element","$attrs","treeConfig",function(a,f,e,b){this.scope=a;a.$element=f;a.$modelValue=null;a.$parentNodeScope=null;a.$childNodesScope=null;a.$parentNodesScope=null;a.$treeScope=null;a.$handleScope=null;a.$type="uiTreeNode";a.$$apply=!1;a.collapsed=!1;a.init=function(b){var d=b[0];a.$treeScope=b[1]?b[1].scope:null;a.$parentNodeScope=d.scope.$nodeScope;a.$modelValue=d.scope.$modelValue[a.$index];a.$parentNodesScope=
d.scope;d.scope.initSubNode(a);f.on("$destroy",function(){d.scope.destroySubNode(a)})};a.index=function(){return a.$parentNodesScope.$modelValue.indexOf(a.$modelValue)};a.dragEnabled=function(){return!(a.$treeScope&&!a.$treeScope.dragEnabled)};a.isSibling=function(b){return a.$parentNodesScope==b.$parentNodesScope};a.isChild=function(b){var d=a.childNodes();return d&&-1<d.indexOf(b)};a.prev=function(){var b=a.index();return 0<b?a.siblings()[b-1]:null};a.siblings=function(){return a.$parentNodesScope.childNodes()};
a.childNodesCount=function(){return a.childNodes()?a.childNodes().length:0};a.hasChild=function(){return 0<a.childNodesCount()};a.childNodes=function(){return a.$childNodesScope&&a.$childNodesScope.$modelValue?a.$childNodesScope.childNodes():null};a.accept=function(b,d){return a.$childNodesScope&&a.$childNodesScope.accept(b,d)};a.remove=function(){return a.$parentNodesScope.removeNode(a)};a.toggle=function(){a.collapsed=!a.collapsed};a.collapse=function(){a.collapsed=!0};a.expand=function(){a.collapsed=
!1};a.depth=function(){var b=a.$parentNodeScope;return b?b.depth()+1:1};var c=0,d=function(a){var b=0;a=a.childNodes();for(var e=0;e<a.length;e++){var f=a[e].$childNodesScope;f&&(b=1,d(f))}c+=b};a.maxSubDepth=function(){c=0;a.$childNodesScope&&d(a.$childNodesScope);return c}}])})();(function(){angular.module("ui.tree").controller("TreeHandleController",["$scope","$element","$attrs","treeConfig",function(a,f,e,b){this.scope=a;a.$element=f;a.$nodeScope=null;a.$type="uiTreeHandle"}])})();
(function(){angular.module("ui.tree").directive("uiTree",["treeConfig","$window",function(a,f){return{restrict:"A",scope:!0,controller:"TreeController",link:function(e,b,c){var d={accept:null},g={};angular.extend(g,a);g.treeClass&&b.addClass(g.treeClass);e.$emptyElm=angular.element(f.document.createElement("div"));g.emptyTreeClass&&e.$emptyElm.addClass(g.emptyTreeClass);e.$watch("$nodesScope.$modelValue.length",function(){e.$nodesScope.$modelValue&&e.resetEmptyElement()},!0);c.$observe("dragEnabled",
function(a){a=e.$eval(a);"boolean"==typeof a&&(e.dragEnabled=a)});c.$observe("maxDepth",function(a){a=e.$eval(a);"number"==typeof a&&(e.maxDepth=a)});c.$observe("dragDelay",function(a){a=e.$eval(a);"number"==typeof a&&(e.dragDelay=a)});d.accept=function(a,b,d){return b.nodrop||b.outOfDepth(a)?!1:!0};d.dropped=function(a){};d.dragStart=function(a){};d.dragMove=function(a){};d.dragStop=function(a){};e.$watch(c.uiTree,function(a,b){angular.forEach(a,function(a,b){d[b]&&"function"===typeof a&&(d[b]=a)});
e.$callbacks=d},!0)}}}])})();
(function(){angular.module("ui.tree").directive("uiTreeNodes",["treeConfig","$window",function(a){return{require:["ngModel","?^uiTreeNode","^uiTree"],restrict:"A",scope:!0,controller:"TreeNodesController",link:function(f,e,b,c){var d={};angular.extend(d,a);d.nodesClass&&e.addClass(d.nodesClass);var g=c[0];e=c[1];c=c[2];e?(e.scope.$childNodesScope=f,f.$nodeScope=e.scope):c.scope.$nodesScope=f;f.$treeScope=c.scope;g&&(g.$render=function(){g.$modelValue&&angular.isArray(g.$modelValue)||g.$setViewValue([]);
f.$modelValue=g.$modelValue});b.$observe("maxDepth",function(a){a=f.$eval(a);"number"==typeof a&&(f.maxDepth=a)});b.$observe("nodrop",function(a){f.nodrop="undefined"!=typeof a})}}}])})();
(function(){angular.module("ui.tree").directive("uiTreeNode",["treeConfig","$uiTreeHelper","$window","$document","$timeout",function(a,f,e,b,c){return{require:["^uiTreeNodes","^uiTree"],restrict:"A",controller:"TreeNodeController",link:function(d,g,q,G){var n={};angular.extend(n,a);n.nodeClass&&g.addClass(n.nodeClass);d.init(G);d.collapsed=!!f.getNodeAttribute(d,"collapsed");q.$observe("collapsed",function(a){a=d.$eval(a);"boolean"==typeof a&&(d.collapsed=a)});d.$watch("collapsed",function(a){f.setNodeAttribute(d,
"collapsed",a);q.$set("collapsed",a)});var H="ontouchstart"in window,v,k,l,m,w,h,t=null,u,C=null,x=document.body,r=document.documentElement,y,A,I=function(a){if((H||2!=a.button&&3!=a.which)&&!(a.uiTreeDragging||a.originalEvent&&a.originalEvent.uiTreeDragging)){var c=angular.element(a.target),p=c.scope();if(p&&p.$type&&("uiTreeNode"==p.$type||"uiTreeHandle"==p.$type)&&("uiTreeNode"!=p.$type||!p.$handleScope)){for(;c&&c[0]&&c[0]!=g;){if(f.nodrag(c))return;c=c.parent()}a.uiTreeDragging=!0;a.originalEvent&&
(a.originalEvent.uiTreeDragging=!0);a.preventDefault();a=f.eventObj(a);v=!0;k=f.dragInfo(d);c=d.$element.prop("tagName");"tr"===c.toLowerCase()?(m=angular.element(e.document.createElement(c)),p=angular.element(e.document.createElement("td")).addClass(n.placeHolderClass),m.append(p)):m=angular.element(e.document.createElement(c)).addClass(n.placeHolderClass);w=angular.element(e.document.createElement(c));n.hiddenClass&&w.addClass(n.hiddenClass);l=f.positionStarted(a,d.$element);m.css("height",f.height(d.$element)+
"px");h=angular.element(e.document.createElement(d.$parentNodesScope.$element.prop("tagName"))).addClass(d.$parentNodesScope.$element.attr("class")).addClass(n.dragClass);h.css("width",f.width(d.$element)+"px");h.css("z-index",9999);d.$element.after(m);d.$element.after(w);h.append(d.$element);b.find("body").append(h);h.css({left:a.pageX-l.offsetX+"px",top:a.pageY-l.offsetY+"px"});u={placeholder:m,dragging:h};d.$apply(function(){d.$callbacks.dragStart(k.eventArgs(u,l))});angular.element(b).bind("touchend",
s);angular.element(b).bind("touchcancel",s);angular.element(b).bind("touchmove",z);angular.element(b).bind("mouseup",s);angular.element(b).bind("mousemove",z);angular.element(b).bind("mouseleave",D);y=Math.max(x.scrollHeight,x.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight);A=Math.max(x.scrollWidth,x.offsetWidth,r.clientWidth,r.scrollWidth,r.offsetWidth)}}},J=function(a){var b=f.eventObj(a),c,g;if(h)if(a.preventDefault(),e.getSelection().removeAllRanges(),c=b.pageX-l.offsetX,g=b.pageY-
l.offsetY,0>c&&(c=0),0>g&&(g=0),g+10>y&&(g=y-10),c+10>A&&(c=A-10),h.css({left:c+"px",top:g+"px"}),c=window.pageYOffset||e.document.documentElement.scrollTop,g=c+(window.innerHeight||e.document.clientHeight||e.document.clientHeight),g<b.pageY&&g<=y&&window.scrollBy(0,10),c>b.pageY&&window.scrollBy(0,-10),f.positionMoved(a,l,v),v)v=!1;else{l.dirAx&&l.distAxX>=n.levelThreshold&&(l.distAxX=0,0<l.distX&&(a=k.prev())&&!a.collapsed&&a.accept(d,a.childNodesCount())&&(a.$childNodesScope.$element.append(m),
k.moveTo(a.$childNodesScope,a.childNodes(),a.childNodesCount())),0>l.distX&&!k.next()&&(a=k.parentNode())&&a.$parentNodesScope.accept(d,a.index()+1)&&(a.$element.after(m),k.moveTo(a.$parentNodesScope,a.siblings(),a.index()+1)));f.offset(h);f.offset(m);a=b.pageX-e.document.body.scrollLeft;c=b.pageY-(window.pageYOffset||e.document.documentElement.scrollTop);angular.isFunction(h.hide)&&h.hide();e.document.elementFromPoint(a,c);c=angular.element(e.document.elementFromPoint(a,c));angular.isFunction(h.show)&&
h.show();if(!l.dirAx){a=c.scope();c=!1;if(!a)return;"uiTree"==a.$type&&a.dragEnabled&&(c=a.isEmpty());"uiTreeHandle"==a.$type&&(a=a.$nodeScope);if("uiTreeNode"!=a.$type&&!c)return;t&&m.parent()[0]!=t.$element[0]&&(t.resetEmptyElement(),t=null);c?(t=a,a.$nodesScope.accept(d,0)&&(a.place(m),k.moveTo(a.$nodesScope,a.$nodesScope.childNodes(),0))):a.dragEnabled()&&(c=a.$element,g=f.offset(c),b=b.pageY<g.top+f.height(c)/2,a.$parentNodesScope.accept(d,a.index())?b?(c[0].parentNode.insertBefore(m[0],c[0]),
k.moveTo(a.$parentNodesScope,a.siblings(),a.index())):(c.after(m),k.moveTo(a.$parentNodesScope,a.siblings(),a.index()+1)):!b&&a.accept(d,a.childNodesCount())&&(a.$childNodesScope.$element.append(m),k.moveTo(a.$childNodesScope,a.childNodes(),a.childNodesCount())))}d.$apply(function(){d.$callbacks.dragMove(k.eventArgs(u,l))})}},B=function(a){a.preventDefault();h&&(w.replaceWith(d.$element),m.remove(),h.remove(),h=null,d.$$apply?(k.apply(),d.$treeScope.$apply(function(){d.$callbacks.dropped(k.eventArgs(u,
l))})):E(),d.$treeScope.$apply(function(){d.$callbacks.dragStop(k.eventArgs(u,l))}),d.$$apply=!1,k=null);angular.element(b).unbind("touchend",s);angular.element(b).unbind("touchcancel",s);angular.element(b).unbind("touchmove",z);angular.element(b).unbind("mouseup",s);angular.element(b).unbind("mousemove",z);angular.element(e.document.body).unbind("mouseleave",D)},F=function(a){d.dragEnabled()&&I(a)},z=function(a){J(a)},s=function(a){d.$$apply=!0;B(a)},D=function(a){B(a)},E=function(){g.bind("touchstart",
F);g.bind("mousedown",function(a){C=c(function(){F(a)},d.dragDelay)});g.bind("mouseup",function(){c.cancel(C)})};E();angular.element(e.document.body).bind("keydown",function(a){27==a.keyCode&&(d.$$apply=!1,B(a))})}}}])})();
(function(){angular.module("ui.tree").directive("uiTreeHandle",["treeConfig","$window",function(a){return{require:"^uiTreeNode",restrict:"A",scope:!0,controller:"TreeHandleController",link:function(f,e,b,c){b={};angular.extend(b,a);b.handleClass&&e.addClass(b.handleClass);f!=c.scope&&(f.$nodeScope=c.scope,c.scope.$handleScope=f)}}}])})();
